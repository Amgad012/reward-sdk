(function(oe,y){typeof exports=="object"&&typeof module<"u"?y(exports,require("react")):typeof define=="function"&&define.amd?define(["exports","react"],y):(oe=typeof globalThis<"u"?globalThis:oe||self,y(oe.RewardSdk={},oe.React))})(this,function(oe,y){"use strict";var Ze={exports:{}},be={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ft;function bt(){if(ft)return be;ft=1;var h=y,O=Symbol.for("react.element"),I=Symbol.for("react.fragment"),c=Object.prototype.hasOwnProperty,Q=h.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,z={key:!0,ref:!0,__self:!0,__source:!0};function Z(k,w,G){var m,j={},A=null,q=null;G!==void 0&&(A=""+G),w.key!==void 0&&(A=""+w.key),w.ref!==void 0&&(q=w.ref);for(m in w)c.call(w,m)&&!z.hasOwnProperty(m)&&(j[m]=w[m]);if(k&&k.defaultProps)for(m in w=k.defaultProps,w)j[m]===void 0&&(j[m]=w[m]);return{$$typeof:O,type:k,key:A,ref:q,props:j,_owner:Q.current}}return be.Fragment=I,be.jsx=Z,be.jsxs=Z,be}var ve={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pt;function vt(){return pt||(pt=1,process.env.NODE_ENV!=="production"&&function(){var h=y,O=Symbol.for("react.element"),I=Symbol.for("react.portal"),c=Symbol.for("react.fragment"),Q=Symbol.for("react.strict_mode"),z=Symbol.for("react.profiler"),Z=Symbol.for("react.provider"),k=Symbol.for("react.context"),w=Symbol.for("react.forward_ref"),G=Symbol.for("react.suspense"),m=Symbol.for("react.suspense_list"),j=Symbol.for("react.memo"),A=Symbol.for("react.lazy"),q=Symbol.for("react.offscreen"),s=Symbol.iterator,E="@@iterator";function V(e){if(e===null||typeof e!="object")return null;var r=s&&e[s]||e[E];return typeof r=="function"?r:null}var L=h.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function _(e){{for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];ee("error",e,n)}}function ee(e,r,n){{var i=L.ReactDebugCurrentFrame,x=i.getStackAddendum();x!==""&&(r+="%s",n=n.concat([x]));var v=n.map(function(g){return String(g)});v.unshift("Warning: "+r),Function.prototype.apply.call(console[e],console,v)}}var Le=!1,te=!1,me=!1,Pe=!1,Ie=!1,Ae;Ae=Symbol.for("react.module.reference");function We(e){return!!(typeof e=="string"||typeof e=="function"||e===c||e===z||Ie||e===Q||e===G||e===m||Pe||e===q||Le||te||me||typeof e=="object"&&e!==null&&(e.$$typeof===A||e.$$typeof===j||e.$$typeof===Z||e.$$typeof===k||e.$$typeof===w||e.$$typeof===Ae||e.getModuleId!==void 0))}function at(e,r,n){var i=e.displayName;if(i)return i;var x=r.displayName||r.name||"";return x!==""?n+"("+x+")":n}function we(e){return e.displayName||"Context"}function $(e){if(e==null)return null;if(typeof e.tag=="number"&&_("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case c:return"Fragment";case I:return"Portal";case z:return"Profiler";case Q:return"StrictMode";case G:return"Suspense";case m:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case k:var r=e;return we(r)+".Consumer";case Z:var n=e;return we(n._context)+".Provider";case w:return at(e,e.render,"ForwardRef");case j:var i=e.displayName||null;return i!==null?i:$(e.type)||"Memo";case A:{var x=e,v=x._payload,g=x._init;try{return $(g(v))}catch{return null}}}return null}var Y=Object.assign,X=0,ue,ot,re,De,Se,Fe,Me;function Ye(){}Ye.__reactDisabledLog=!0;function Te(){{if(X===0){ue=console.log,ot=console.info,re=console.warn,De=console.error,Se=console.group,Fe=console.groupCollapsed,Me=console.groupEnd;var e={configurable:!0,enumerable:!0,value:Ye,writable:!0};Object.defineProperties(console,{info:e,log:e,warn:e,error:e,group:e,groupCollapsed:e,groupEnd:e})}X++}}function yt(){{if(X--,X===0){var e={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:Y({},e,{value:ue}),info:Y({},e,{value:ot}),warn:Y({},e,{value:re}),error:Y({},e,{value:De}),group:Y({},e,{value:Se}),groupCollapsed:Y({},e,{value:Fe}),groupEnd:Y({},e,{value:Me})})}X<0&&_("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var ke=L.ReactCurrentDispatcher,H;function d(e,r,n){{if(H===void 0)try{throw Error()}catch(x){var i=x.stack.trim().match(/\n( *(at )?)/);H=i&&i[1]||""}return`
`+H+e}}var Ue=!1,pe;{var it=typeof WeakMap=="function"?WeakMap:Map;pe=new it}function ze(e,r){if(!e||Ue)return"";{var n=pe.get(e);if(n!==void 0)return n}var i;Ue=!0;var x=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var v;v=ke.current,ke.current=null,Te();try{if(r){var g=function(){throw Error()};if(Object.defineProperty(g.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(g,[])}catch(M){i=M}Reflect.construct(e,[],g)}else{try{g.call()}catch(M){i=M}e.call(g.prototype)}}else{try{throw Error()}catch(M){i=M}e()}}catch(M){if(M&&i&&typeof M.stack=="string"){for(var u=M.stack.split(`
`),D=i.stack.split(`
`),T=u.length-1,R=D.length-1;T>=1&&R>=0&&u[T]!==D[R];)R--;for(;T>=1&&R>=0;T--,R--)if(u[T]!==D[R]){if(T!==1||R!==1)do if(T--,R--,R<0||u[T]!==D[R]){var N=`
`+u[T].replace(" at new "," at ");return e.displayName&&N.includes("<anonymous>")&&(N=N.replace("<anonymous>",e.displayName)),typeof e=="function"&&pe.set(e,N),N}while(T>=1&&R>=0);break}}}finally{Ue=!1,ke.current=v,yt(),Error.prepareStackTrace=x}var ye=e?e.displayName||e.name:"",fe=ye?d(ye):"";return typeof e=="function"&&pe.set(e,fe),fe}function st(e,r,n){return ze(e,!1)}function Be(e){var r=e.prototype;return!!(r&&r.isReactComponent)}function ge(e,r,n){if(e==null)return"";if(typeof e=="function")return ze(e,Be(e));if(typeof e=="string")return d(e);switch(e){case G:return d("Suspense");case m:return d("SuspenseList")}if(typeof e=="object")switch(e.$$typeof){case w:return st(e.render);case j:return ge(e.type,r,n);case A:{var i=e,x=i._payload,v=i._init;try{return ge(v(x),r,n)}catch{}}}return""}var se=Object.prototype.hasOwnProperty,le={},Ne=L.ReactDebugCurrentFrame;function F(e){if(e){var r=e._owner,n=ge(e.type,e._source,r?r.type:null);Ne.setExtraStackFrame(n)}else Ne.setExtraStackFrame(null)}function lt(e,r,n,i,x){{var v=Function.call.bind(se);for(var g in e)if(v(e,g)){var u=void 0;try{if(typeof e[g]!="function"){var D=Error((i||"React class")+": "+n+" type `"+g+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof e[g]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw D.name="Invariant Violation",D}u=e[g](r,g,i,n,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(T){u=T}u&&!(u instanceof Error)&&(F(x),_("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",i||"React class",n,g,typeof u),F(null)),u instanceof Error&&!(u.message in le)&&(le[u.message]=!0,F(x),_("Failed %s type: %s",n,u.message),F(null))}}}var ct=Array.isArray;function je(e){return ct(e)}function Ve(e){{var r=typeof Symbol=="function"&&Symbol.toStringTag,n=r&&e[Symbol.toStringTag]||e.constructor.name||"Object";return n}}function Ce(e){try{return $e(e),!1}catch{return!0}}function $e(e){return""+e}function Re(e){if(Ce(e))return _("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",Ve(e)),$e(e)}var he=L.ReactCurrentOwner,dt={key:!0,ref:!0,__self:!0,__source:!0},He,Je;function Ge(e){if(se.call(e,"ref")){var r=Object.getOwnPropertyDescriptor(e,"ref").get;if(r&&r.isReactWarning)return!1}return e.ref!==void 0}function t(e){if(se.call(e,"key")){var r=Object.getOwnPropertyDescriptor(e,"key").get;if(r&&r.isReactWarning)return!1}return e.key!==void 0}function o(e,r){typeof e.ref=="string"&&he.current}function l(e,r){{var n=function(){He||(He=!0,_("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",r))};n.isReactWarning=!0,Object.defineProperty(e,"key",{get:n,configurable:!0})}}function f(e,r){{var n=function(){Je||(Je=!0,_("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",r))};n.isReactWarning=!0,Object.defineProperty(e,"ref",{get:n,configurable:!0})}}var C=function(e,r,n,i,x,v,g){var u={$$typeof:O,type:e,key:r,ref:n,props:g,_owner:v};return u._store={},Object.defineProperty(u._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(u,"_self",{configurable:!1,enumerable:!1,writable:!1,value:i}),Object.defineProperty(u,"_source",{configurable:!1,enumerable:!1,writable:!1,value:x}),Object.freeze&&(Object.freeze(u.props),Object.freeze(u)),u};function S(e,r,n,i,x){{var v,g={},u=null,D=null;n!==void 0&&(Re(n),u=""+n),t(r)&&(Re(r.key),u=""+r.key),Ge(r)&&(D=r.ref,o(r,x));for(v in r)se.call(r,v)&&!dt.hasOwnProperty(v)&&(g[v]=r[v]);if(e&&e.defaultProps){var T=e.defaultProps;for(v in T)g[v]===void 0&&(g[v]=T[v])}if(u||D){var R=typeof e=="function"?e.displayName||e.name||"Unknown":e;u&&l(g,R),D&&f(g,R)}return C(e,u,D,x,i,he.current,g)}}var p=L.ReactCurrentOwner,U=L.ReactDebugCurrentFrame;function W(e){if(e){var r=e._owner,n=ge(e.type,e._source,r?r.type:null);U.setExtraStackFrame(n)}else U.setExtraStackFrame(null)}var ne;ne=!1;function ce(e){return typeof e=="object"&&e!==null&&e.$$typeof===O}function K(){{if(p.current){var e=$(p.current.type);if(e)return`

Check the render method of \``+e+"`."}return""}}function ae(e){return""}var J={};function de(e){{var r=K();if(!r){var n=typeof e=="string"?e:e.displayName||e.name;n&&(r=`

Check the top-level render call using <`+n+">.")}return r}}function B(e,r){{if(!e._store||e._store.validated||e.key!=null)return;e._store.validated=!0;var n=de(r);if(J[n])return;J[n]=!0;var i="";e&&e._owner&&e._owner!==p.current&&(i=" It was passed a child from "+$(e._owner.type)+"."),W(e),_('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',n,i),W(null)}}function Ee(e,r){{if(typeof e!="object")return;if(je(e))for(var n=0;n<e.length;n++){var i=e[n];ce(i)&&B(i,r)}else if(ce(e))e._store&&(e._store.validated=!0);else if(e){var x=V(e);if(typeof x=="function"&&x!==e.entries)for(var v=x.call(e),g;!(g=v.next()).done;)ce(g.value)&&B(g.value,r)}}}function Xe(e){{var r=e.type;if(r==null||typeof r=="string")return;var n;if(typeof r=="function")n=r.propTypes;else if(typeof r=="object"&&(r.$$typeof===w||r.$$typeof===j))n=r.propTypes;else return;if(n){var i=$(r);lt(n,e.props,"prop",i,e)}else if(r.PropTypes!==void 0&&!ne){ne=!0;var x=$(r);_("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",x||"Unknown")}typeof r.getDefaultProps=="function"&&!r.getDefaultProps.isReactClassApproved&&_("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function Ke(e){{for(var r=Object.keys(e.props),n=0;n<r.length;n++){var i=r[n];if(i!=="children"&&i!=="key"){W(e),_("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",i),W(null);break}}e.ref!==null&&(W(e),_("Invalid attribute `ref` supplied to `React.Fragment`."),W(null))}}var _e={};function Oe(e,r,n,i,x,v){{var g=We(e);if(!g){var u="";(e===void 0||typeof e=="object"&&e!==null&&Object.keys(e).length===0)&&(u+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var D=ae();D?u+=D:u+=K();var T;e===null?T="null":je(e)?T="array":e!==void 0&&e.$$typeof===O?(T="<"+($(e.type)||"Unknown")+" />",u=" Did you accidentally export a JSX literal instead of a component?"):T=typeof e,_("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",T,u)}var R=S(e,r,n,x,v);if(R==null)return R;if(g){var N=r.children;if(N!==void 0)if(i)if(je(N)){for(var ye=0;ye<N.length;ye++)Ee(N[ye],e);Object.freeze&&Object.freeze(N)}else _("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else Ee(N,e)}if(se.call(r,"key")){var fe=$(e),M=Object.keys(r).filter(function(kt){return kt!=="key"}),ut=M.length>0?"{key: someKey, "+M.join(": ..., ")+": ...}":"{key: someKey}";if(!_e[fe+ut]){var Tt=M.length>0?"{"+M.join(": ..., ")+": ...}":"{}";_(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,ut,fe,Tt,fe),_e[fe+ut]=!0}}return e===c?Ke(R):Xe(R),R}}function Qe(e,r,n){return Oe(e,r,n,!0)}function b(e,r,n){return Oe(e,r,n,!1)}var P=b,xe=Qe;ve.Fragment=c,ve.jsx=P,ve.jsxs=xe}()),ve}process.env.NODE_ENV==="production"?Ze.exports=bt():Ze.exports=vt();var a=Ze.exports;const mt=({showPreferences:h,skipPreferences:O,topicsDict:I,colors:c,formatTopicName:Q,prefSubmitStatus:z,updateProfile:Z})=>{const[k,w]=y.useState({});y.useEffect(()=>{h&&w({...I})},[h,I]);const G=s=>{w(E=>({...E,[s]:!E[s]}))},m=()=>{const E=!Object.values(k).every(L=>L===!0),V={};Object.keys(k).forEach(L=>{V[L]=E}),w(V)},j=Object.values(k).every(s=>s===!0),A=()=>{const s=Object.keys(k).filter(ee=>k[ee]),E=Object.keys(I).filter(ee=>I[ee]);let V=!1;s.length!==E.length?V=!0:V=s.some(ee=>!E.includes(ee));const L=s.length===0,_=Object.keys(k).length;Z({tempTopicsDict:k,allTopicsSelected:j,newSelectedTopics:s,oldSelectedTopics:E,noTopicsSelected:L,hasChanges:V,totalTopicsCount:_})},q=s=>{s.target===s.currentTarget&&O()};return h?a.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:q,children:a.jsxs("div",{style:{backgroundColor:c.containerBg,borderRadius:"8px",width:"95%",maxWidth:"600px",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.2)",animation:"fadeInUp 0.3s",overflow:"hidden",display:"flex",flexDirection:"column"},children:[a.jsxs("div",{style:{padding:`${window.innerWidth<480?"24px 16px":"32px"} ${window.innerWidth<480?"16px":"32px"} 0`,overflow:"auto",flexGrow:1,maxHeight:window.innerWidth<480?"calc(90vh - 100px)":"calc(80vh - 100px)"},children:[a.jsx("style",{children:`
            @keyframes fadeInUp {
              from { opacity: 0; transform: translateY(20px); }
              to { opacity: 1; transform: translateY(0); }
            }
          `}),a.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0px"},children:a.jsx("h2",{style:{margin:0,color:c.text,fontSize:window.innerWidth<480?"20px":"26px",userSelect:"none",cursor:"default"},children:"Your interests"})}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"46px"},children:[a.jsx("p",{style:{color:c.textLight,margin:0,fontSize:"18px",userSelect:"none",cursor:"default"},children:"Select topics you're interested in"}),a.jsxs("div",{onClick:m,style:{padding:"8px 12px",borderRadius:"8px",border:`1px solid ${j?c.primary:c.border}`,backgroundColor:j?c.primaryLight:"white",cursor:"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:"8px",height:"36px",boxSizing:"border-box",boxShadow:"0 2px 4px rgba(0,0,0,0.05)",width:"140px",marginLeft:"auto",justifyContent:"flex-start",overflow:"hidden"},children:[a.jsx("div",{style:{width:"16px",height:"16px",minWidth:"16px",borderRadius:"4px",border:`2px solid ${j?c.primary:c.secondary}`,backgroundColor:j?c.primary:"white",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,transition:"all 0.2s ease",position:"relative",left:"0"},children:j&&a.jsx("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:a.jsx("path",{d:"M5 13L9 17L19 7",stroke:"white",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"})})}),a.jsx("span",{style:{color:j?c.primary:c.text,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",userSelect:"none",flex:"0 1 auto"},children:j?"Unselect all":"Select all"})]})]}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:window.innerWidth<480?"repeat(auto-fill, minmax(130px, 1fr))":"repeat(auto-fill, minmax(180px, 1fr))",gap:window.innerWidth<480?"8px":"16px",paddingBottom:"80px"},children:Object.entries(k).map(([s,E])=>a.jsxs("div",{onClick:()=>G(s),style:{padding:"12px 16px",borderRadius:"8px",border:`1px solid ${E?c.primary:c.border}`,backgroundColor:E?c.primaryLight:"white",cursor:"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:"8px",height:"46px",boxSizing:"border-box",userSelect:"none"},children:[a.jsx("div",{style:{width:"18px",height:"18px",minWidth:"18px",borderRadius:"4px",border:`2px solid ${E?c.primary:c.secondary}`,backgroundColor:E?c.primary:"white",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,transition:"all 0.2s ease"},children:E&&a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:a.jsx("path",{d:"M5 13L9 17L19 7",stroke:"white",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"})})}),a.jsx("span",{style:{color:E?c.primary:c.text,fontWeight:E?"500":"normal",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",flex:"1",userSelect:"none"},children:Q(s)})]},s))}),z&&a.jsx("div",{style:{marginTop:"24px",marginBottom:"24px",padding:"12px 16px",borderRadius:"8px",backgroundColor:z.type==="success"?c.successLight:c.errorLight,color:z.type==="success"?c.success:c.error,animation:"fadeIn 0.3s"},children:z.message})]}),a.jsxs("div",{style:{padding:(window.innerWidth<480,"8px 24px 8px 0px"),marginTop:"auto",display:"flex",justifyContent:"flex-end",gap:"16px",borderTop:`1px solid ${c.border}`,backgroundColor:`${c.containerBg}ee`,boxShadow:"0 -4px 6px rgba(255, 179, 179, 0.03)",position:"relative"},children:[a.jsx("button",{onClick:O,style:{padding:"10px 24px",backgroundColor:"white",color:c.text,border:`1px solid ${c.border}`,borderRadius:"8px",cursor:"pointer",fontSize:"16px",transition:"all 0.2s ease",userSelect:"none"},onMouseOver:s=>{s.currentTarget.style.backgroundColor=c.secondary+"15",s.currentTarget.style.boxShadow="0 4px 8px rgba(0,0,0,0.1)",s.currentTarget.style.border=`1px solid ${c.secondary}`},onMouseOut:s=>{s.currentTarget.style.backgroundColor="white",s.currentTarget.style.boxShadow="none",s.currentTarget.style.border=`1px solid ${c.border}`},children:"Skip"}),a.jsx("button",{onClick:A,style:{padding:"10px 24px",backgroundColor:c.primary,color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"16px",transition:"all 0.2s ease",userSelect:"none"},onMouseOver:s=>{s.currentTarget.style.backgroundColor="#2563eb",s.currentTarget.style.boxShadow="0 4px 12px rgba(59, 130, 246, 0.4)"},onMouseOut:s=>{s.currentTarget.style.backgroundColor=c.primary,s.currentTarget.style.boxShadow="none"},children:"Save"})]})]})}):null},qe="rewardSdk_sessionId",gt="rewardSdk_languages";let ie=null,et=!1,tt=[];if(typeof window<"u"){const h=localStorage.getItem(qe);h&&(ie=h)}const ht=()=>{let h=[];if(navigator.languages&&navigator.languages.length){const O=new Set;h=navigator.languages.map(I=>I.split("-")[0]).filter(I=>O.has(I)?!1:(O.add(I),!0))}else h=[navigator.language.split("-")[0]];return h},xt=()=>{try{const h=localStorage.getItem(gt);return h?JSON.parse(h):[]}catch(h){return console.error("Error parsing stored languages:",h),[]}},rt=h=>{try{localStorage.setItem(gt,JSON.stringify(h))}catch(O){console.error("Error storing languages:",O)}},wt=(h=null)=>(h?(ie=h,localStorage.setItem(qe,h)):(ie=null,localStorage.removeItem(qe)),!0),St=()=>!!ie,nt=({apiKey:h="89b668d3f2af4e2ea9e0e44d74620b44",apiBaseUrl:O="https://label-api.fly.dev/",taskCount:I="3",customStyle:c={},onRewardGranted:Q,onClose:z})=>{if(!h)throw new Error("RewardSdk: apiKey is required but not provided in props or environment variables");if(!O)throw new Error("API base URL is not configured in props or environment variables");const Z=async()=>{if(A(!0),St())await ge()||F();else{const t=Be();le(t)}},[k,w]=y.useState(null),[G,m]=y.useState(!1),[j,A]=y.useState(!0),[q,s]=y.useState(null),[E,V]=y.useState({}),[L,_]=y.useState(I),[ee,Le]=y.useState(!0),[te,me]=y.useState(!1),[Pe,Ie]=y.useState(""),[Ae,We]=y.useState(0),[at,we]=y.useState(0),[$,Y]=y.useState(!1),[X,ue]=y.useState({}),[ot,re]=y.useState(!1),[De,Se]=y.useState(null),[Fe,Me]=y.useState(!1),Ye=["profile","user","task","name"][Math.floor(Math.random()*4)],[Te]=y.useState(`${Ye}_${Math.random().toString(36).substring(2,7)}`),[yt,ke]=y.useState(window.innerWidth),H=async(t,o="GET",l=null,f={})=>{const C={requiresSession:!0,onRedirect:le,setLoading:!0},{requiresSession:S,onRedirect:p,setLoading:U}={...C,...f};try{U&&m(!0),s(null);const W=`${O}${t}`,ne={Accept:"application/json","Content-Type":"application/json"};S&&ie&&(ne["X-Session-ID"]=ie),h&&(ne["X-API-KEY"]=h);const ce={method:o,headers:ne};l&&(o==="POST"||o==="PUT")&&(ce.body=JSON.stringify(l));const K=await fetch(W,ce);if(K.status===307){if(U&&m(!1),et)return new Promise((J,de)=>{tt.push({endpoint:t,method:o,body:l,options:f,resolve:J,reject:de})});et=!0;try{const J=p?await p():null,de=tt.map(B=>H(B.endpoint,B.method,B.body,B.options).then(B.resolve,B.reject));return tt=[],await Promise.allSettled(de),J||H(t,o,l,f)}finally{et=!1}}let ae;try{ae=await K.json()}catch{ae={detail:`API responded with status: ${K.status}`}}if(!K.ok)throw new Error(ae.detail||ae.error||`API responded with status: ${K.status}`);return ae}catch(W){throw s(W.message||"Failed to connect to API. Is the server running?"),W}finally{U&&m(!1)}},d={background:"#f8fafc",containerBg:"#ffffff",primary:"#3b82f6",primaryLight:"#dbeafe",secondary:"#64748b",secondaryLight:"#f1f5f9",secondaryV:"#f0f9ff",success:"#10b981",successLight:"#d1fae5",error:"#ef4444",errorLight:"#fee2e2",text:"#334155",textLight:"#64748b",border:"#e2e8f0",warning:"#f59e0b",warningLight:"#fef3c7"},pe={...{backgroundColor:"transparent",borderRadius:"8px",color:d.text,fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif',Width:"100%",overflowY:"auto",Height:"100%",userSelect:"none"},...c},it=()=>{if(!document.getElementById("reward-sdk-responsive-styles")){const t=document.createElement("style");t.id="reward-sdk-responsive-styles",t.innerHTML=`
        @media screen and (max-width: 767px) {
          .reward-sdk-container .task-container {
            flex-direction: column !important;
          }
          .reward-sdk-container .task-left-half {
            width: 100% !important;
          }
          .reward-sdk-container .task-right-half {
            width: 100% !important;
            padding: 16px !important;
            margin: 0 !important;
          }
        }
      `,document.head.appendChild(t)}},ze=()=>{Ie("Only correct answers count"),We(t=>t+1)},st=()=>{Ie(""),_(t=>Math.max(0,t-1))},Be=()=>{const t=ht();return rt(t),t},ge=async()=>{const t=xt(),o=ht();if(o.length!==t.length)return rt(o),await le(o),!0;for(let l=0;l<o.length;l++)if(o[l]!==t[l])return rt(o),await le(o),!0;return!1},se=()=>{const t=Be();le(t)};y.useEffect(()=>{window.addEventListener("languagechange",se);const t=()=>{ke(window.innerWidth)};return window.addEventListener("resize",t),it(),Z(),()=>{window.removeEventListener("languagechange",se),window.removeEventListener("resize",t)}},[]);const le=async(t=null)=>{try{m(!0),s(null);const l={langs:t||xt()},f=`${O}identity/`,C={Accept:"application/json","Content-Type":"application/json"};h&&(C["X-API-KEY"]=h),ie&&(C["X-Session-ID"]=ie);const S=await fetch(f,{method:"POST",headers:C,body:JSON.stringify(l)});let p;try{p=await S.json()}catch{p={detail:`API responded with status: ${S.status}`}}if(!S.ok)throw new Error(p.detail||p.error||`API responded with status: ${S.status}`);return p.session_id&&p.api_topics&&p.message==="new_user"?(wt(p.session_id),he(p.api_topics,null),Me(!0),m(!1),A(!1),Y(!0),p):p.message==="language_updated"?(setTimeout(()=>F(),0),p):(s("Unexpected response from identity endpoint"),m(!1),A(!1),null)}catch(o){return s(o.message||"Failed to connect to identity endpoint"),m(!1),A(!1),null}},Ne=t=>{var C,S,p;if(!Array.isArray(t)||t.length===0)return!1;const o=t[0],l=(S=(C=o==null?void 0:o.content)==null?void 0:C.image)==null?void 0:S.url,f=(p=o==null?void 0:o.task)==null?void 0:p.text;return!!(l&&f)},F=async(t=!1)=>{try{A(!1),me(!1);let o="task/";t&&Math.random()<.5&&(o+="?complexity=1");const l=await H(o,"GET");if(!Ne(l)){s("Failed to get a task. Please try again.");return}w(l),V({}),ee&&t&&Le(!1)}catch{}},lt=()=>{F(!0)},ct=async(t,o,l)=>{if(!te)try{me(!0);const f={task_id:t,track_id:l,solution:o},C=L===1;C?(f.wrong_answers=Ae,f.total_tasks=at):m(!0);const S=document.getElementById(Te);S&&S.value&&(f.callEndPoint=S.value);const p=await H("solution/","POST",f);we(W=>W+1);const U=C&&(p==null?void 0:p.result)==="correct";if(p&&p.result==="wrong"){ze(),F(!0);return}else p&&p.result==="correct"&&st();Le(!1),U?(We(0),we(0),alert("Reward granted 🎁"),Q&&Q()):F()}catch(f){V(C=>({...C,[t]:{status:"error",message:`Error: ${f.message}`}})),me(!1)}},je=async()=>{try{return re(!0),(await H("topics/","GET",null,{requiresSession:!1,setLoading:!1})).api_topics||[]}catch{return[]}finally{re(!1)}},Ve=async()=>{try{return(await H("profile/","GET",null,{setLoading:!1})).user_topics||[]}catch{return[]}},Ce=async(t=[])=>{re(!0),Se(null);try{if((await H("profile/update/","POST",{topics:t},{setLoading:!1})).message==="profile_updated")Y(!1),F();else throw new Error("Unexpected response from profile update")}catch(o){Se({type:"error",message:`Failed to save preferences: ${o.message}`})}finally{re(!1)}},$e=t=>{const{tempTopicsDict:o,allTopicsSelected:l,newSelectedTopics:f,oldSelectedTopics:C,noTopicsSelected:S,hasChanges:p,totalTopicsCount:U}=t;if(!p){Re();return}ue(o),!l&&!S?Ce(f):l&&C.length===0||S&&C.length===U?(Y(!1),F()):Ce(l?[]:f)},Re=()=>{Y(!1),F()},he=(t,o)=>{if(t!=null&&o!==void 0&&o!==null){const l={};return t.forEach(f=>{l[f]=o.includes(f)}),ue(l),l}else if(t!=null&&t.length>0){const l={};return t.forEach(f=>{l[f]=!1}),ue(l),l}else if(o!=null){const l={...X};return Object.keys(l).forEach(f=>{l[f]=!1}),Array.isArray(o)&&o.forEach(f=>{f in l&&(l[f]=!0)}),ue(l),l}return X},dt=async()=>{if(Object.keys(X).length===0)try{const t=await je(),o=await Ve();return he(t,o),!0}catch(t){return s(`Failed to update topics: ${t.message}`),!1}if(Fe)try{const t=await Ve();he(null,t)}catch(t){return s(`Failed to update topics for new user: ${t.message}`),!1}return!0},He=async()=>{re(!0);try{await dt()&&Y(!0)}catch(t){s(`Failed to prepare preferences: ${t.message}`)}finally{re(!1)}},Je=t=>t.toLowerCase()==="uae"?"UAE":t.charAt(0).toUpperCase()+t.slice(1).replace(/-/g," "),Ge=(t,o=!1)=>{var J,de,B,Ee,Xe,Ke,_e,Oe,Qe;if(!t&&!o||!o&&(!t.id||!((de=(J=t.content)==null?void 0:J.image)!=null&&de.url)||!((B=t.task)!=null&&B.text)))return null;const l=b=>!b||typeof b!="string"?"":b.charAt(0).toUpperCase()+b.slice(1),f={border:"#cbd5e1",image:"#94a3b8"},C={backgroundColor:"transparent",marginBottom:"20px",transition:"all 0.3s ease",display:"flex",flexDirection:"row",width:"100%",opacity:o?"0.85":"1",position:"relative",boxSizing:"border-box"},S=640,p=480,U=S/p,W={width:"50%",display:"flex",alignItems:"center",justifyContent:"center",padding:"16px",boxSizing:"border-box","@media (max-width: 768px)":{paddingRight:"0px"}},ne={width:"50%",display:"flex",flexDirection:"column",padding:"16px",margin:"0",borderRadius:"8px",boxSizing:"border-box",justifyContent:"space-between","@media (max-width: 768px)":{alignSelf:"center",width:"100%"}},ce={width:"100%",height:"auto",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden",backgroundColor:(o||(Xe=(Ee=t==null?void 0:t.content)==null?void 0:Ee.image)!=null&&Xe.url,"transparent"),borderRadius:"8px",boxSizing:"border-box",aspectRatio:`${U}`},K={fontSize:"20px",fontWeight:"600",margin:"0 0 16px",padding:"16px",backgroundColor:o?f.image:"transparent",borderRadius:"8px",lineHeight:"1.4",color:o?"transparent":d.text,letterSpacing:"0.01em",animation:o?"pulse 1.5s infinite ease-in-out":"none",minHeight:"80px",height:o?"80px":"auto"},ae={padding:"10px 20px",backgroundColor:d.secondaryLight,color:d.secondary,borderRadius:"30px",cursor:"pointer",border:`1px solid ${d.border}`,fontSize:"14px",fontWeight:"500",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",marginTop:"auto",marginBottom:"0",marginLeft:"auto",width:"auto",minWidth:"80px",userSelect:"none"};return a.jsxs("div",{style:C,className:"task-container",children:[a.jsx("div",{style:W,className:"task-left-half",children:a.jsxs("div",{style:ce,children:[!o&&((_e=(Ke=t.content)==null?void 0:Ke.image)==null?void 0:_e.url)&&a.jsx("img",{src:t.content.image.url,alt:t.content.image.filename||"Task image",style:{width:"100%",height:"100%",objectFit:"contain",borderRadius:"8px",boxShadow:"0 4px 8px rgba(0,0,0,0.08)"}}),o&&a.jsx("div",{style:{width:"100%",height:"100%",aspectRatio:`${S} / ${p}`,backgroundColor:f.image,borderRadius:"8px",animation:"pulse 1.5s infinite ease-in-out"}})]})}),a.jsxs("div",{style:ne,className:"task-right-half",children:[a.jsxs("div",{className:"right-side-top",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[a.jsx("div",{style:{flex:1},children:Pe&&a.jsxs("div",{style:{backgroundColor:d.warningLight,color:d.warning,padding:"5px 20px",borderRadius:"30px",fontWeight:"500",fontSize:"16px",display:"flex",alignItems:"center",gap:"6px",border:`1px solid ${d.warning}30`,animation:"fadeIn 0.5s",maxWidth:"fit-content"},children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:a.jsx("path",{d:"M12 9V14M12 19H12.01M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),Pe]})}),a.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:L>0&&Array.isArray(k)&&a.jsxs("div",{style:{backgroundColor:d.secondaryLight,color:d.secondary,padding:"5px 15px",borderRadius:"30px",fontWeight:"500",fontSize:"16px",display:"flex",alignItems:"center",gap:"2px",border:`1px solid ${d.border}`,position:"relative",cursor:"pointer",transition:"all 0.3s ease",marginLeft:"auto",userSelect:"none"},onMouseEnter:b=>{const P=b.currentTarget.querySelector(".tasks-tooltip");P&&(P.style.visibility="visible",P.style.opacity="1")},onMouseLeave:b=>{const P=b.currentTarget.querySelector(".tasks-tooltip");P&&(P.style.visibility="hidden",P.style.opacity="0")},children:[a.jsx("span",{style:{backgroundColor:d.primary,width:"10px",height:"10px",borderRadius:"50%",display:"inline-block",marginRight:"8px"}}),a.jsx("span",{children:L}),a.jsxs("div",{className:"tasks-tooltip",style:{visibility:"hidden",opacity:0,position:"absolute",bottom:"calc(100% + 10px)",left:"50%",transform:"translateX(-50%)",backgroundColor:d.text,color:"white",padding:"6px 12px",borderRadius:"6px",fontSize:"14px",whiteSpace:"nowrap",zIndex:10,boxShadow:"0 4px 8px rgba(0,0,0,0.15)",transition:"all 0.3s ease"},children:[L===1?"Task":"Tasks"," Remaining",a.jsx("div",{style:{position:"absolute",top:"100%",left:"50%",transform:"translateX(-50%)",width:0,height:0,borderLeft:"6px solid transparent",borderRight:"6px solid transparent",borderTop:`6px solid ${d.text}`}})]})]})})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",justifyContent:"flex-start",flex:"1",minHeight:"250px"},children:[a.jsx("div",{style:{...K,marginTop:"20px"},children:o?"":l(((Oe=t.task)==null?void 0:Oe.text)||"")}),a.jsxs("div",{style:{marginTop:"20px",marginBottom:"20px",display:"flex",flexWrap:"wrap",gap:"20px",justifyContent:"center"},children:[!o&&a.jsx("input",{type:"text",name:Te,id:Te,style:{position:"absolute",left:"-9999px",opacity:0,height:"0",width:"0",overflow:"hidden",display:"none",visibility:"hidden",pointerEvents:"none"},"aria-hidden":"true",tabIndex:"-1"}),o?Array.from({length:4}).map((b,P)=>a.jsx("button",{disabled:!0,style:{padding:"10px 20px",backgroundColor:f.image,borderRadius:"20px",border:`1px solid ${f.border}`,minWidth:"80px",height:"38px",animation:"pulse 1.5s infinite ease-in-out",cursor:"default"}},`skeleton-choice-${P}`)):((Qe=t.task)==null?void 0:Qe.choices)&&t.task.choices.map(b=>{let P=b.value;t.type==="true-false"?(b.value==="True"&&(P="Yes"),b.value==="False"&&(P="No")):P=l(P);const xe={padding:"10px 20px",backgroundColor:te?`${d.secondaryLight}80`:d.secondaryV,color:te?`${d.text}80`:d.text,borderRadius:"20px",border:`1px solid ${d.border}`,transition:"all 0.2s ease",fontSize:"16px",fontWeight:"500",boxShadow:"0 2px 4px rgba(0,0,0,0.14)",minWidth:"80px",height:"38px",opacity:te?.7:1,userSelect:"none"};return a.jsx("button",{onClick:()=>ct(t.id,b.key,t.track_id),disabled:te,style:xe,onMouseOver:e=>{te||(e.currentTarget.style.backgroundColor=d.secondary,e.currentTarget.style.color="white",e.currentTarget.style.boxShadow="0 4px 8px rgba(0,0,0,0.12)",e.currentTarget.style.transform="translateY(-1px)")},onMouseOut:e=>{te||Object.assign(e.currentTarget.style,{backgroundColor:xe.backgroundColor,color:xe.color,boxShadow:xe.boxShadow,transform:"translateY(0)"})},children:P},b.key)})]})]}),a.jsx("div",{children:!o&&a.jsxs("button",{onClick:lt,style:ae,onMouseOver:b=>{b.currentTarget.style.backgroundColor=d.containerBg,b.currentTarget.style.color="#000000",b.currentTarget.style.transform="translateY(-2px)",b.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.08)"},onMouseOut:b=>{b.currentTarget.style.backgroundColor=d.secondaryLight,b.currentTarget.style.color=d.secondary,b.currentTarget.style.transform="translateY(0)",b.currentTarget.style.boxShadow="none"},children:["Skip",a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:a.jsx("path",{d:"M9 6L15 12L9 18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]})})]})]},o?"skeleton":t.id)};return a.jsxs("div",{className:"reward-sdk-container",style:{...pe,padding:"0px 20px 0px 20px",position:"relative"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",alignItems:"center",padding:"15px 16px 5px 20px ",gap:"10px"},children:[a.jsx("button",{onClick:He,title:"Preferences",style:{width:"32px",height:"32px",background:"transparent",border:"none",cursor:"pointer",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",color:d.secondary,transition:"all 0.2s ease",backgroundColor:"#e0e0e0",userSelect:"none",fontSize:"16px",fontWeight:"bold"},onMouseOver:t=>{t.currentTarget.style.color="#000000",t.currentTarget.style.backgroundColor="#d4d4d4",t.currentTarget.style.boxShadow="0 2px 5px rgba(0,0,0,0.2)"},onMouseOut:t=>{t.currentTarget.style.color=d.secondary,t.currentTarget.style.backgroundColor="#e0e0e0",t.currentTarget.style.boxShadow="none"},children:"☰"}),z&&a.jsx("button",{onClick:()=>{window.confirm("Won't get a reward")&&z()},style:{width:"32px",height:"32px",borderRadius:"50%",backgroundColor:"#e0e0e0",color:d.secondary,border:"none",fontSize:"16px",fontWeight:"bold",cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center",padding:"0",boxShadow:"none",transition:"all 0.2s ease",userSelect:"none"},onMouseOver:t=>{t.currentTarget.style.color="#000000",t.currentTarget.style.backgroundColor="#d4d4d4",t.currentTarget.style.boxShadow="0 2px 5px rgba(0,0,0,0.2)"},onMouseOut:t=>{t.currentTarget.style.color=d.secondary,t.currentTarget.style.backgroundColor="#e0e0e0",t.currentTarget.style.boxShadow="none"},"aria-label":"Close",children:"✕"})]}),a.jsx(mt,{showPreferences:$,skipPreferences:Re,topicsDict:X,colors:d,formatTopicName:Je,prefSubmitStatus:De,updateProfile:$e}),!$&&a.jsx(a.Fragment,{children:G&&!j?a.jsx("div",{children:Ge(null,!0)}):q?a.jsxs("div",{style:{padding:"40px 20px",textAlign:"center",backgroundColor:d.errorLight,borderRadius:"12px",color:d.error,border:`1px solid ${d.error}25`},children:[a.jsx("div",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"8px"},children:"Connection Error"}),a.jsx("div",{children:q}),a.jsx("button",{onClick:F,style:{marginTop:"20px",padding:"10px 20px",backgroundColor:d.error,color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"500",userSelect:"none"},children:"Retry Connection"})]}):a.jsx("div",{children:Array.isArray(k)?a.jsx(a.Fragment,{children:k.map(t=>Ge(t,!1))}):null})})]})};typeof window<"u"&&(window.RewardSdk||(window.RewardSdk=nt)),oe.RewardSdk=nt,oe.default=nt,Object.defineProperties(oe,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
