(function(oe,v){typeof exports=="object"&&typeof module<"u"?v(exports,require("react")):typeof define=="function"&&define.amd?define(["exports","react"],v):(oe=typeof globalThis<"u"?globalThis:oe||self,v(oe.RewardSdk={},oe.React))})(this,function(oe,v){"use strict";var Ze={exports:{}},ve={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ft;function bt(){if(ft)return ve;ft=1;var c=v,y=Symbol.for("react.element"),P=Symbol.for("react.fragment"),u=Object.prototype.hasOwnProperty,Q=c.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,U={key:!0,ref:!0,__self:!0,__source:!0};function Z(j,S,G){var w,C={},A=null,q=null;G!==void 0&&(A=""+G),S.key!==void 0&&(A=""+S.key),S.ref!==void 0&&(q=S.ref);for(w in S)u.call(S,w)&&!U.hasOwnProperty(w)&&(C[w]=S[w]);if(j&&j.defaultProps)for(w in S=j.defaultProps,S)C[w]===void 0&&(C[w]=S[w]);return{$$typeof:y,type:j,key:A,ref:q,props:C,_owner:Q.current}}return ve.Fragment=P,ve.jsx=Z,ve.jsxs=Z,ve}var be={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pt;function mt(){return pt||(pt=1,process.env.NODE_ENV!=="production"&&function(){var c=v,y=Symbol.for("react.element"),P=Symbol.for("react.portal"),u=Symbol.for("react.fragment"),Q=Symbol.for("react.strict_mode"),U=Symbol.for("react.profiler"),Z=Symbol.for("react.provider"),j=Symbol.for("react.context"),S=Symbol.for("react.forward_ref"),G=Symbol.for("react.suspense"),w=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),A=Symbol.for("react.lazy"),q=Symbol.for("react.offscreen"),i=Symbol.iterator,_="@@iterator";function V(e){if(e===null||typeof e!="object")return null;var r=i&&e[i]||e[_];return typeof r=="function"?r:null}var L=c.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function O(e){{for(var r=arguments.length,a=new Array(r>1?r-1:0),s=1;s<r;s++)a[s-1]=arguments[s];ee("error",e,a)}}function ee(e,r,a){{var s=L.ReactDebugCurrentFrame,h=s.getStackAddendum();h!==""&&(r+="%s",a=a.concat([h]));var m=a.map(function(x){return String(x)});m.unshift("Warning: "+r),Function.prototype.apply.call(console[e],console,m)}}var Le=!1,te=!1,me=!1,Ie=!1,Pe=!1,Ae;Ae=Symbol.for("react.module.reference");function We(e){return!!(typeof e=="string"||typeof e=="function"||e===u||e===U||Pe||e===Q||e===G||e===w||Ie||e===q||Le||te||me||typeof e=="object"&&e!==null&&(e.$$typeof===A||e.$$typeof===C||e.$$typeof===Z||e.$$typeof===j||e.$$typeof===S||e.$$typeof===Ae||e.getModuleId!==void 0))}function at(e,r,a){var s=e.displayName;if(s)return s;var h=r.displayName||r.name||"";return h!==""?a+"("+h+")":a}function we(e){return e.displayName||"Context"}function $(e){if(e==null)return null;if(typeof e.tag=="number"&&O("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case u:return"Fragment";case P:return"Portal";case U:return"Profiler";case Q:return"StrictMode";case G:return"Suspense";case w:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case j:var r=e;return we(r)+".Consumer";case Z:var a=e;return we(a._context)+".Provider";case S:return at(e,e.render,"ForwardRef");case C:var s=e.displayName||null;return s!==null?s:$(e.type)||"Memo";case A:{var h=e,m=h._payload,x=h._init;try{return $(x(m))}catch{return null}}}return null}var z=Object.assign,X=0,de,ot,re,De,Se,Fe,Me;function ze(){}ze.__reactDisabledLog=!0;function Te(){{if(X===0){de=console.log,ot=console.info,re=console.warn,De=console.error,Se=console.group,Fe=console.groupCollapsed,Me=console.groupEnd;var e={configurable:!0,enumerable:!0,value:ze,writable:!0};Object.defineProperties(console,{info:e,log:e,warn:e,error:e,group:e,groupCollapsed:e,groupEnd:e})}X++}}function vt(){{if(X--,X===0){var e={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:z({},e,{value:de}),info:z({},e,{value:ot}),warn:z({},e,{value:re}),error:z({},e,{value:De}),group:z({},e,{value:Se}),groupCollapsed:z({},e,{value:Fe}),groupEnd:z({},e,{value:Me})})}X<0&&O("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var ke=L.ReactCurrentDispatcher,H;function d(e,r,a){{if(H===void 0)try{throw Error()}catch(h){var s=h.stack.trim().match(/\n( *(at )?)/);H=s&&s[1]||""}return`
`+H+e}}var Ye=!1,pe;{var st=typeof WeakMap=="function"?WeakMap:Map;pe=new st}function Ue(e,r){if(!e||Ye)return"";{var a=pe.get(e);if(a!==void 0)return a}var s;Ye=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var m;m=ke.current,ke.current=null,Te();try{if(r){var x=function(){throw Error()};if(Object.defineProperty(x.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(x,[])}catch(M){s=M}Reflect.construct(e,[],x)}else{try{x.call()}catch(M){s=M}e.call(x.prototype)}}else{try{throw Error()}catch(M){s=M}e()}}catch(M){if(M&&s&&typeof M.stack=="string"){for(var f=M.stack.split(`
`),D=s.stack.split(`
`),k=f.length-1,E=D.length-1;k>=1&&E>=0&&f[k]!==D[E];)E--;for(;k>=1&&E>=0;k--,E--)if(f[k]!==D[E]){if(k!==1||E!==1)do if(k--,E--,E<0||f[k]!==D[E]){var N=`
`+f[k].replace(" at new "," at ");return e.displayName&&N.includes("<anonymous>")&&(N=N.replace("<anonymous>",e.displayName)),typeof e=="function"&&pe.set(e,N),N}while(k>=1&&E>=0);break}}}finally{Ye=!1,ke.current=m,vt(),Error.prepareStackTrace=h}var ye=e?e.displayName||e.name:"",fe=ye?d(ye):"";return typeof e=="function"&&pe.set(e,fe),fe}function it(e,r,a){return Ue(e,!1)}function Be(e){var r=e.prototype;return!!(r&&r.isReactComponent)}function ge(e,r,a){if(e==null)return"";if(typeof e=="function")return Ue(e,Be(e));if(typeof e=="string")return d(e);switch(e){case G:return d("Suspense");case w:return d("SuspenseList")}if(typeof e=="object")switch(e.$$typeof){case S:return it(e.render);case C:return ge(e.type,r,a);case A:{var s=e,h=s._payload,m=s._init;try{return ge(m(h),r,a)}catch{}}}return""}var ie=Object.prototype.hasOwnProperty,le={},Ne=L.ReactDebugCurrentFrame;function F(e){if(e){var r=e._owner,a=ge(e.type,e._source,r?r.type:null);Ne.setExtraStackFrame(a)}else Ne.setExtraStackFrame(null)}function lt(e,r,a,s,h){{var m=Function.call.bind(ie);for(var x in e)if(m(e,x)){var f=void 0;try{if(typeof e[x]!="function"){var D=Error((s||"React class")+": "+a+" type `"+x+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof e[x]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw D.name="Invariant Violation",D}f=e[x](r,x,s,a,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(k){f=k}f&&!(f instanceof Error)&&(F(h),O("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",s||"React class",a,x,typeof f),F(null)),f instanceof Error&&!(f.message in le)&&(le[f.message]=!0,F(h),O("Failed %s type: %s",a,f.message),F(null))}}}var ct=Array.isArray;function je(e){return ct(e)}function Ve(e){{var r=typeof Symbol=="function"&&Symbol.toStringTag,a=r&&e[Symbol.toStringTag]||e.constructor.name||"Object";return a}}function Ce(e){try{return $e(e),!1}catch{return!0}}function $e(e){return""+e}function Re(e){if(Ce(e))return O("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",Ve(e)),$e(e)}var xe=L.ReactCurrentOwner,ut={key:!0,ref:!0,__self:!0,__source:!0},He,Je;function Ge(e){if(ie.call(e,"ref")){var r=Object.getOwnPropertyDescriptor(e,"ref").get;if(r&&r.isReactWarning)return!1}return e.ref!==void 0}function t(e){if(ie.call(e,"key")){var r=Object.getOwnPropertyDescriptor(e,"key").get;if(r&&r.isReactWarning)return!1}return e.key!==void 0}function o(e,r){typeof e.ref=="string"&&xe.current}function l(e,r){{var a=function(){He||(He=!0,O("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",r))};a.isReactWarning=!0,Object.defineProperty(e,"key",{get:a,configurable:!0})}}function p(e,r){{var a=function(){Je||(Je=!0,O("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",r))};a.isReactWarning=!0,Object.defineProperty(e,"ref",{get:a,configurable:!0})}}var R=function(e,r,a,s,h,m,x){var f={$$typeof:y,type:e,key:r,ref:a,props:x,_owner:m};return f._store={},Object.defineProperty(f._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(f,"_self",{configurable:!1,enumerable:!1,writable:!1,value:s}),Object.defineProperty(f,"_source",{configurable:!1,enumerable:!1,writable:!1,value:h}),Object.freeze&&(Object.freeze(f.props),Object.freeze(f)),f};function T(e,r,a,s,h){{var m,x={},f=null,D=null;a!==void 0&&(Re(a),f=""+a),t(r)&&(Re(r.key),f=""+r.key),Ge(r)&&(D=r.ref,o(r,h));for(m in r)ie.call(r,m)&&!ut.hasOwnProperty(m)&&(x[m]=r[m]);if(e&&e.defaultProps){var k=e.defaultProps;for(m in k)x[m]===void 0&&(x[m]=k[m])}if(f||D){var E=typeof e=="function"?e.displayName||e.name||"Unknown":e;f&&l(x,E),D&&p(x,E)}return R(e,f,D,h,s,xe.current,x)}}var g=L.ReactCurrentOwner,Y=L.ReactDebugCurrentFrame;function W(e){if(e){var r=e._owner,a=ge(e.type,e._source,r?r.type:null);Y.setExtraStackFrame(a)}else Y.setExtraStackFrame(null)}var ne;ne=!1;function ce(e){return typeof e=="object"&&e!==null&&e.$$typeof===y}function K(){{if(g.current){var e=$(g.current.type);if(e)return`

Check the render method of \``+e+"`."}return""}}function ae(e){return""}var J={};function ue(e){{var r=K();if(!r){var a=typeof e=="string"?e:e.displayName||e.name;a&&(r=`

Check the top-level render call using <`+a+">.")}return r}}function B(e,r){{if(!e._store||e._store.validated||e.key!=null)return;e._store.validated=!0;var a=ue(r);if(J[a])return;J[a]=!0;var s="";e&&e._owner&&e._owner!==g.current&&(s=" It was passed a child from "+$(e._owner.type)+"."),W(e),O('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',a,s),W(null)}}function Ee(e,r){{if(typeof e!="object")return;if(je(e))for(var a=0;a<e.length;a++){var s=e[a];ce(s)&&B(s,r)}else if(ce(e))e._store&&(e._store.validated=!0);else if(e){var h=V(e);if(typeof h=="function"&&h!==e.entries)for(var m=h.call(e),x;!(x=m.next()).done;)ce(x.value)&&B(x.value,r)}}}function Xe(e){{var r=e.type;if(r==null||typeof r=="string")return;var a;if(typeof r=="function")a=r.propTypes;else if(typeof r=="object"&&(r.$$typeof===S||r.$$typeof===C))a=r.propTypes;else return;if(a){var s=$(r);lt(a,e.props,"prop",s,e)}else if(r.PropTypes!==void 0&&!ne){ne=!0;var h=$(r);O("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",h||"Unknown")}typeof r.getDefaultProps=="function"&&!r.getDefaultProps.isReactClassApproved&&O("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function Ke(e){{for(var r=Object.keys(e.props),a=0;a<r.length;a++){var s=r[a];if(s!=="children"&&s!=="key"){W(e),O("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",s),W(null);break}}e.ref!==null&&(W(e),O("Invalid attribute `ref` supplied to `React.Fragment`."),W(null))}}var _e={};function Oe(e,r,a,s,h,m){{var x=We(e);if(!x){var f="";(e===void 0||typeof e=="object"&&e!==null&&Object.keys(e).length===0)&&(f+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var D=ae();D?f+=D:f+=K();var k;e===null?k="null":je(e)?k="array":e!==void 0&&e.$$typeof===y?(k="<"+($(e.type)||"Unknown")+" />",f=" Did you accidentally export a JSX literal instead of a component?"):k=typeof e,O("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",k,f)}var E=T(e,r,a,h,m);if(E==null)return E;if(x){var N=r.children;if(N!==void 0)if(s)if(je(N)){for(var ye=0;ye<N.length;ye++)Ee(N[ye],e);Object.freeze&&Object.freeze(N)}else O("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else Ee(N,e)}if(ie.call(r,"key")){var fe=$(e),M=Object.keys(r).filter(function(_t){return _t!=="key"}),dt=M.length>0?"{key: someKey, "+M.join(": ..., ")+": ...}":"{key: someKey}";if(!_e[fe+dt]){var Et=M.length>0?"{"+M.join(": ..., ")+": ...}":"{}";O(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,dt,fe,Et,fe),_e[fe+dt]=!0}}return e===u?Ke(E):Xe(E),E}}function Qe(e,r,a){return Oe(e,r,a,!0)}function b(e,r,a){return Oe(e,r,a,!1)}var I=b,he=Qe;be.Fragment=u,be.jsx=I,be.jsxs=he}()),be}process.env.NODE_ENV==="production"?Ze.exports=bt():Ze.exports=mt();var n=Ze.exports;const wt=({width:c=18,height:y=18})=>n.jsx("svg",{width:c,height:y,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:n.jsx("path",{d:"M12 9V14M12 19H12.01M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),St=({width:c=14,height:y=14})=>n.jsx("svg",{width:c,height:y,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:n.jsx("path",{d:"M9 6L15 12L9 18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),Tt=({width:c=15,height:y=15})=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",width:c,height:y,fill:"currentColor",children:n.jsx("path",{d:"M0 96C0 78.3 14.3 64 32 64l384 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L32 128C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32l384 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L32 288c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32L32 448c-17.7 0-32-14.3-32-32s14.3-32 32-32l384 0c17.7 0 32 14.3 32 32z"})}),kt=({width:c=16,height:y=16})=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",width:c,height:y,fill:"currentColor",children:n.jsx("path",{d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"})}),gt=({width:c=12,height:y=12})=>n.jsx("svg",{width:c,height:y,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:n.jsx("path",{d:"M5 13L9 17L19 7",stroke:"white",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"})}),jt=({showPreferences:c,skipPreferences:y,topicsDict:P,colors:u,formatTopicName:Q,prefSubmitStatus:U,updateProfile:Z})=>{const[j,S]=v.useState({});v.useEffect(()=>{c&&S({...P})},[c,P]);const G=i=>{S(_=>({..._,[i]:!_[i]}))},w=()=>{const _=!Object.values(j).every(L=>L===!0),V={};Object.keys(j).forEach(L=>{V[L]=_}),S(V)},C=Object.values(j).every(i=>i===!0),A=()=>{const i=Object.keys(j).filter(ee=>j[ee]),_=Object.keys(P).filter(ee=>P[ee]);let V=!1;i.length!==_.length?V=!0:V=i.some(ee=>!_.includes(ee));const L=i.length===0,O=Object.keys(j).length;Z({tempTopicsDict:j,allTopicsSelected:C,newSelectedTopics:i,oldSelectedTopics:_,noTopicsSelected:L,hasChanges:V,totalTopicsCount:O})},q=i=>{i.target===i.currentTarget&&y()};return c?n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:q,children:n.jsxs("div",{style:{backgroundColor:u.containerBg,borderRadius:"8px",width:"95%",maxWidth:"600px",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.2)",animation:"fadeInUp 0.3s",overflow:"hidden",display:"flex",flexDirection:"column"},children:[n.jsxs("div",{style:{padding:`${window.innerWidth<480?"24px 16px":"32px"} ${window.innerWidth<480?"16px":"32px"} 0`,overflow:"auto",flexGrow:1,maxHeight:window.innerWidth<480?"calc(90vh - 100px)":"calc(80vh - 100px)"},children:[n.jsx("style",{children:`
            @keyframes fadeInUp {
              from { opacity: 0; transform: translateY(20px); }
              to { opacity: 1; transform: translateY(0); }
            }
          `}),n.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0px"},children:n.jsx("h2",{style:{margin:0,color:u.text,fontSize:window.innerWidth<480?"20px":"26px",userSelect:"none",cursor:"default"},children:"Your interests"})}),n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"46px"},children:[n.jsx("p",{style:{color:u.textLight,margin:0,fontSize:"18px",userSelect:"none",cursor:"default"},children:"Select topics you're interested in"}),n.jsxs("div",{onClick:w,style:{padding:"8px 12px",borderRadius:"8px",border:`1px solid ${C?u.primary:u.border}`,backgroundColor:C?u.primaryLight:"white",cursor:"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:"8px",height:"36px",boxSizing:"border-box",boxShadow:"0 2px 4px rgba(0,0,0,0.05)",width:"140px",marginLeft:"auto",justifyContent:"flex-start",overflow:"hidden"},children:[n.jsxs("div",{style:{width:"16px",height:"16px",minWidth:"16px",borderRadius:"4px",border:`2px solid ${C?u.primary:u.secondary}`,backgroundColor:C?u.primary:"white",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,transition:"all 0.2s ease",position:"relative",left:"0"},children:["                ",C&&n.jsx(gt,{width:10,height:10})]}),n.jsx("span",{style:{color:C?u.primary:u.text,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",userSelect:"none",flex:"0 1 auto"},children:C?"Unselect all":"Select all"})]})]}),n.jsx("div",{style:{display:"grid",gridTemplateColumns:window.innerWidth<480?"repeat(auto-fill, minmax(130px, 1fr))":"repeat(auto-fill, minmax(180px, 1fr))",gap:window.innerWidth<480?"8px":"16px",paddingBottom:"80px"},children:Object.entries(j).map(([i,_])=>n.jsxs("div",{onClick:()=>G(i),style:{padding:"12px 16px",borderRadius:"8px",border:`1px solid ${_?u.primary:u.border}`,backgroundColor:_?u.primaryLight:"white",cursor:"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:"8px",height:"46px",boxSizing:"border-box",userSelect:"none"},children:[n.jsxs("div",{style:{width:"18px",height:"18px",minWidth:"18px",borderRadius:"4px",border:`2px solid ${_?u.primary:u.secondary}`,backgroundColor:_?u.primary:"white",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,transition:"all 0.2s ease"},children:["                  ",_&&n.jsx(gt,{})]}),n.jsx("span",{style:{color:_?u.primary:u.text,fontWeight:_?"500":"normal",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",flex:"1",userSelect:"none"},children:Q(i)})]},i))}),U&&n.jsx("div",{style:{marginTop:"24px",marginBottom:"24px",padding:"12px 16px",borderRadius:"8px",backgroundColor:U.type==="success"?u.successLight:u.errorLight,color:U.type==="success"?u.success:u.error,animation:"fadeIn 0.3s"},children:U.message})]}),n.jsxs("div",{style:{padding:(window.innerWidth<480,"8px 24px 8px 0px"),marginTop:"auto",display:"flex",justifyContent:"flex-end",gap:"16px",borderTop:`1px solid ${u.border}`,backgroundColor:`${u.containerBg}ee`,boxShadow:"0 -4px 6px rgba(255, 179, 179, 0.03)",position:"relative"},children:[n.jsx("button",{onClick:y,style:{padding:"10px 24px",backgroundColor:"white",color:u.text,border:`1px solid ${u.border}`,borderRadius:"8px",cursor:"pointer",fontSize:"16px",transition:"all 0.2s ease",userSelect:"none"},onMouseOver:i=>{i.currentTarget.style.backgroundColor=u.secondary+"15",i.currentTarget.style.boxShadow="0 4px 8px rgba(0,0,0,0.1)",i.currentTarget.style.border=`1px solid ${u.secondary}`},onMouseOut:i=>{i.currentTarget.style.backgroundColor="white",i.currentTarget.style.boxShadow="none",i.currentTarget.style.border=`1px solid ${u.border}`},children:"Skip"}),n.jsx("button",{onClick:A,style:{padding:"10px 24px",backgroundColor:u.primary,color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"16px",transition:"all 0.2s ease",userSelect:"none"},onMouseOver:i=>{i.currentTarget.style.backgroundColor="#2563eb",i.currentTarget.style.boxShadow="0 4px 12px rgba(59, 130, 246, 0.4)"},onMouseOut:i=>{i.currentTarget.style.backgroundColor=u.primary,i.currentTarget.style.boxShadow="none"},children:"Save"})]})]})}):null},qe="rewardSdk_sessionId",xt="rewardSdk_languages";let se=null,et=!1,tt=[];if(typeof window<"u"){const c=localStorage.getItem(qe);c&&(se=c)}const ht=()=>{let c=[];if(navigator.languages&&navigator.languages.length){const y=new Set;c=navigator.languages.map(P=>P.split("-")[0]).filter(P=>y.has(P)?!1:(y.add(P),!0))}else c=[navigator.language.split("-")[0]];return c},yt=()=>{try{const c=localStorage.getItem(xt);return c?JSON.parse(c):[]}catch(c){return console.error("Error parsing stored languages:",c),[]}},rt=c=>{try{localStorage.setItem(xt,JSON.stringify(c))}catch(y){console.error("Error storing languages:",y)}},Ct=(c=null)=>(c?(se=c,localStorage.setItem(qe,c)):(se=null,localStorage.removeItem(qe)),!0),Rt=()=>!!se,nt=({apiKey:c="89b668d3f2af4e2ea9e0e44d74620b44",apiBaseUrl:y="https://label-api.fly.dev/",taskCount:P="3",customStyle:u={},onRewardGranted:Q,onClose:U})=>{if(!c)throw new Error("RewardSdk: apiKey is required but not provided in props or environment variables");if(!y)throw new Error("API base URL is not configured in props or environment variables");const Z=async()=>{if(A(!0),Rt())await ge()||F();else{const t=Be();le(t)}},[j,S]=v.useState(null),[G,w]=v.useState(!1),[C,A]=v.useState(!0),[q,i]=v.useState(null),[_,V]=v.useState({}),[L,O]=v.useState(P),[ee,Le]=v.useState(!0),[te,me]=v.useState(!1),[Ie,Pe]=v.useState(""),[Ae,We]=v.useState(0),[at,we]=v.useState(0),[$,z]=v.useState(!1),[X,de]=v.useState({}),[ot,re]=v.useState(!1),[De,Se]=v.useState(null),[Fe,Me]=v.useState(!1),ze=["profile","user","task","name"][Math.floor(Math.random()*4)],[Te]=v.useState(`${ze}_${Math.random().toString(36).substring(2,7)}`),[vt,ke]=v.useState(window.innerWidth),H=async(t,o="GET",l=null,p={})=>{const R={requiresSession:!0,onRedirect:le,setLoading:!0},{requiresSession:T,onRedirect:g,setLoading:Y}={...R,...p};try{Y&&w(!0),i(null);const W=`${y}${t}`,ne={Accept:"application/json","Content-Type":"application/json"};T&&se&&(ne["X-Session-ID"]=se),c&&(ne["X-API-KEY"]=c);const ce={method:o,headers:ne};l&&(o==="POST"||o==="PUT")&&(ce.body=JSON.stringify(l));const K=await fetch(W,ce);if(K.status===307){if(Y&&w(!1),et)return new Promise((J,ue)=>{tt.push({endpoint:t,method:o,body:l,options:p,resolve:J,reject:ue})});et=!0;try{const J=g?await g():null,ue=tt.map(B=>H(B.endpoint,B.method,B.body,B.options).then(B.resolve,B.reject));return tt=[],await Promise.allSettled(ue),J||H(t,o,l,p)}finally{et=!1}}let ae;try{ae=await K.json()}catch{ae={detail:`API responded with status: ${K.status}`}}if(!K.ok)throw new Error(ae.detail||ae.error||`API responded with status: ${K.status}`);return ae}catch(W){throw i(W.message||"Failed to connect to API. Is the server running?"),W}finally{Y&&w(!1)}},d={background:"#f8fafc",containerBg:"#ffffff",primary:"#3b82f6",primaryLight:"#dbeafe",secondary:"#64748b",secondaryLight:"#f1f5f9",secondaryV:"#f0f9ff",success:"#10b981",successLight:"#d1fae5",error:"#ef4444",errorLight:"#fee2e2",text:"#334155",textLight:"#64748b",border:"#e2e8f0",warning:"#f59e0b",warningLight:"#fef3c7"},pe={...{backgroundColor:"transparent",borderRadius:"8px",color:d.text,fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif',Width:"100%",overflowY:"auto",Height:"100%",userSelect:"none"},...u},st=()=>{if(!document.getElementById("reward-sdk-responsive-styles")){const t=document.createElement("style");t.id="reward-sdk-responsive-styles",t.innerHTML=`
        @media screen and (max-width: 767px) {
          .reward-sdk-container .task-container {
            flex-direction: column !important;
          }
          .reward-sdk-container .task-left-half {
            width: 100% !important;
          }
          .reward-sdk-container .task-right-half {
            width: 100% !important;
            padding: 16px !important;
            margin: 0 !important;
          }
        }
      `,document.head.appendChild(t)}},Ue=()=>{Pe("Only correct answers count"),We(t=>t+1)},it=()=>{Pe(""),O(t=>Math.max(0,t-1))},Be=()=>{const t=ht();return rt(t),t},ge=async()=>{const t=yt(),o=ht();if(o.length!==t.length)return rt(o),await le(o),!0;for(let l=0;l<o.length;l++)if(o[l]!==t[l])return rt(o),await le(o),!0;return!1},ie=()=>{const t=Be();le(t)};v.useEffect(()=>{window.addEventListener("languagechange",ie);const t=()=>{ke(window.innerWidth)};return window.addEventListener("resize",t),st(),Z(),()=>{window.removeEventListener("languagechange",ie),window.removeEventListener("resize",t)}},[]);const le=async(t=null)=>{try{w(!0),i(null);const l={langs:t||yt()},p=`${y}identity/`,R={Accept:"application/json","Content-Type":"application/json"};c&&(R["X-API-KEY"]=c),se&&(R["X-Session-ID"]=se);const T=await fetch(p,{method:"POST",headers:R,body:JSON.stringify(l)});let g;try{g=await T.json()}catch{g={detail:`API responded with status: ${T.status}`}}if(!T.ok)throw new Error(g.detail||g.error||`API responded with status: ${T.status}`);return g.session_id&&g.api_topics&&g.message==="new_user"?(Ct(g.session_id),xe(g.api_topics,null),Me(!0),w(!1),A(!1),z(!0),g):g.message==="language_updated"?(setTimeout(()=>F(),0),g):(i("Unexpected response from identity endpoint"),w(!1),A(!1),null)}catch(o){return i(o.message||"Failed to connect to identity endpoint"),w(!1),A(!1),null}},Ne=t=>{var R,T,g;if(!Array.isArray(t)||t.length===0)return!1;const o=t[0],l=(T=(R=o==null?void 0:o.content)==null?void 0:R.image)==null?void 0:T.url,p=(g=o==null?void 0:o.task)==null?void 0:g.text;return!!(l&&p)},F=async(t=!1)=>{try{A(!1),me(!1);let o="task/";t&&Math.random()<.5&&(o+="?complexity=1");const l=await H(o,"GET");if(!Ne(l)){i("Failed to get a task. Please try again.");return}S(l),V({}),ee&&t&&Le(!1)}catch{}},lt=()=>{F(!0)},ct=async(t,o,l)=>{if(!te)try{me(!0);const p={task_id:t,track_id:l,solution:o},R=L===1;R?(p.wrong_answers=Ae,p.total_tasks=at):w(!0);const T=document.getElementById(Te);T&&T.value&&(p.callEndPoint=T.value);const g=await H("solution/","POST",p);we(W=>W+1);const Y=R&&(g==null?void 0:g.result)==="correct";if(g&&g.result==="wrong"){Ue(),F(!0);return}else g&&g.result==="correct"&&it();Le(!1),Y?(We(0),we(0),alert("Reward granted 🎁"),Q&&Q()):F()}catch(p){V(R=>({...R,[t]:{status:"error",message:`Error: ${p.message}`}})),me(!1)}},je=async()=>{try{return re(!0),(await H("topics/","GET",null,{requiresSession:!1,setLoading:!1})).api_topics||[]}catch{return[]}finally{re(!1)}},Ve=async()=>{try{return(await H("profile/","GET",null,{setLoading:!1})).user_topics||[]}catch{return[]}},Ce=async(t=[])=>{re(!0),Se(null);try{if((await H("profile/update/","POST",{topics:t},{setLoading:!1})).message==="profile_updated")z(!1),F();else throw new Error("Unexpected response from profile update")}catch(o){Se({type:"error",message:`Failed to save preferences: ${o.message}`})}finally{re(!1)}},$e=t=>{const{tempTopicsDict:o,allTopicsSelected:l,newSelectedTopics:p,oldSelectedTopics:R,noTopicsSelected:T,hasChanges:g,totalTopicsCount:Y}=t;if(!g){Re();return}de(o),!l&&!T?Ce(p):l&&R.length===0||T&&R.length===Y?(z(!1),F()):Ce(l?[]:p)},Re=()=>{z(!1),F()},xe=(t,o)=>{if(t!=null&&o!==void 0&&o!==null){const l={};return t.forEach(p=>{l[p]=o.includes(p)}),de(l),l}else if(t!=null&&t.length>0){const l={};return t.forEach(p=>{l[p]=!1}),de(l),l}else if(o!=null){const l={...X};return Object.keys(l).forEach(p=>{l[p]=!1}),Array.isArray(o)&&o.forEach(p=>{p in l&&(l[p]=!0)}),de(l),l}return X},ut=async()=>{if(Object.keys(X).length===0)try{const t=await je(),o=await Ve();return xe(t,o),!0}catch(t){return i(`Failed to update topics: ${t.message}`),!1}if(Fe)try{const t=await Ve();xe(null,t)}catch(t){return i(`Failed to update topics for new user: ${t.message}`),!1}return!0},He=async()=>{re(!0);try{await ut()&&z(!0)}catch(t){i(`Failed to prepare preferences: ${t.message}`)}finally{re(!1)}},Je=t=>t.toLowerCase()==="uae"?"UAE":t.charAt(0).toUpperCase()+t.slice(1).replace(/-/g," "),Ge=(t,o=!1)=>{var J,ue,B,Ee,Xe,Ke,_e,Oe,Qe;if(!t&&!o||!o&&(!t.id||!((ue=(J=t.content)==null?void 0:J.image)!=null&&ue.url)||!((B=t.task)!=null&&B.text)))return null;const l=b=>!b||typeof b!="string"?"":b.charAt(0).toUpperCase()+b.slice(1),p={border:"#cbd5e1",image:"#94a3b8"},R={backgroundColor:"transparent",marginBottom:"20px",transition:"all 0.3s ease",display:"flex",flexDirection:"row",width:"100%",opacity:o?"0.85":"1",position:"relative",boxSizing:"border-box"},T=640,g=480,Y=T/g,W={width:"50%",display:"flex",alignItems:"center",justifyContent:"center",padding:"16px",boxSizing:"border-box","@media (max-width: 768px)":{paddingRight:"0px"}},ne={width:"50%",display:"flex",flexDirection:"column",padding:"16px",margin:"0",borderRadius:"8px",boxSizing:"border-box",justifyContent:"space-between","@media (max-width: 768px)":{alignSelf:"center",width:"100%"}},ce={width:"100%",height:"auto",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden",backgroundColor:(o||(Xe=(Ee=t==null?void 0:t.content)==null?void 0:Ee.image)!=null&&Xe.url,"transparent"),borderRadius:"8px",boxSizing:"border-box",aspectRatio:`${Y}`},K={fontSize:"20px",fontWeight:"600",margin:"0 0 16px",padding:"16px",backgroundColor:o?p.image:"transparent",borderRadius:"8px",lineHeight:"1.4",color:o?"transparent":d.text,letterSpacing:"0.01em",animation:o?"pulse 1.5s infinite ease-in-out":"none",minHeight:"80px",height:o?"80px":"auto"},ae={padding:"10px 20px",backgroundColor:d.secondaryLight,color:d.secondary,borderRadius:"30px",cursor:"pointer",border:`1px solid ${d.border}`,fontSize:"14px",fontWeight:"500",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",marginTop:"auto",marginBottom:"0",marginLeft:"auto",width:"auto",minWidth:"80px",userSelect:"none"};return n.jsxs("div",{style:R,className:"task-container",children:[n.jsx("div",{style:W,className:"task-left-half",children:n.jsxs("div",{style:ce,children:[!o&&((_e=(Ke=t.content)==null?void 0:Ke.image)==null?void 0:_e.url)&&n.jsx("img",{src:t.content.image.url,alt:t.content.image.filename||"Task image",style:{width:"100%",height:"100%",objectFit:"contain",borderRadius:"8px",boxShadow:"0 4px 8px rgba(0,0,0,0.08)"}}),o&&n.jsx("div",{style:{width:"100%",height:"100%",aspectRatio:`${T} / ${g}`,backgroundColor:p.image,borderRadius:"8px",animation:"pulse 1.5s infinite ease-in-out"}})]})}),n.jsxs("div",{style:ne,className:"task-right-half",children:[n.jsxs("div",{className:"right-side-top",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[n.jsx("div",{style:{flex:1},children:Ie&&n.jsxs("div",{style:{backgroundColor:d.warningLight,color:d.warning,padding:"5px 20px",borderRadius:"30px",fontWeight:"500",fontSize:"16px",display:"flex",alignItems:"center",gap:"6px",border:`1px solid ${d.warning}30`,animation:"fadeIn 0.5s",maxWidth:"fit-content"},children:[n.jsx(wt,{}),Ie]})}),n.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:L>0&&Array.isArray(j)&&n.jsxs("div",{style:{backgroundColor:d.secondaryLight,color:d.secondary,padding:"5px 15px",borderRadius:"30px",fontWeight:"500",fontSize:"16px",display:"flex",alignItems:"center",gap:"2px",border:`1px solid ${d.border}`,position:"relative",cursor:"pointer",transition:"all 0.3s ease",marginLeft:"auto",userSelect:"none"},onMouseEnter:b=>{const I=b.currentTarget.querySelector(".tasks-tooltip");I&&(I.style.visibility="visible",I.style.opacity="1")},onMouseLeave:b=>{const I=b.currentTarget.querySelector(".tasks-tooltip");I&&(I.style.visibility="hidden",I.style.opacity="0")},children:[n.jsx("span",{style:{backgroundColor:d.primary,width:"10px",height:"10px",borderRadius:"50%",display:"inline-block",marginRight:"8px"}}),n.jsx("span",{children:L}),n.jsxs("div",{className:"tasks-tooltip",style:{visibility:"hidden",opacity:0,position:"absolute",bottom:"calc(100% + 10px)",left:"50%",transform:"translateX(-50%)",backgroundColor:d.text,color:"white",padding:"6px 12px",borderRadius:"6px",fontSize:"14px",whiteSpace:"nowrap",zIndex:10,boxShadow:"0 4px 8px rgba(0,0,0,0.15)",transition:"all 0.3s ease"},children:[L===1?"Task":"Tasks"," Remaining",n.jsx("div",{style:{position:"absolute",top:"100%",left:"50%",transform:"translateX(-50%)",width:0,height:0,borderLeft:"6px solid transparent",borderRight:"6px solid transparent",borderTop:`6px solid ${d.text}`}})]})]})})]}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",justifyContent:"flex-start",flex:"1",minHeight:"250px"},children:[n.jsx("div",{style:{...K,marginTop:"20px"},children:o?"":l(((Oe=t.task)==null?void 0:Oe.text)||"")}),n.jsxs("div",{style:{marginTop:"20px",marginBottom:"20px",display:"flex",flexWrap:"wrap",gap:"20px",justifyContent:"center"},children:[!o&&n.jsx("input",{type:"text",name:Te,id:Te,style:{position:"absolute",left:"-9999px",opacity:0,height:"0",width:"0",overflow:"hidden",display:"none",visibility:"hidden",pointerEvents:"none"},"aria-hidden":"true",tabIndex:"-1"}),o?Array.from({length:4}).map((b,I)=>n.jsx("button",{disabled:!0,style:{padding:"10px 20px",backgroundColor:p.image,borderRadius:"20px",border:`1px solid ${p.border}`,minWidth:"80px",height:"38px",animation:"pulse 1.5s infinite ease-in-out",cursor:"default"}},`skeleton-choice-${I}`)):((Qe=t.task)==null?void 0:Qe.choices)&&t.task.choices.map(b=>{let I=b.value;t.type==="true-false"?(b.value==="True"&&(I="Yes"),b.value==="False"&&(I="No")):I=l(I);const he={padding:"10px 20px",backgroundColor:te?`${d.secondaryLight}80`:d.secondaryV,color:te?`${d.text}80`:d.text,borderRadius:"20px",border:`1px solid ${d.border}`,transition:"all 0.2s ease",fontSize:"16px",fontWeight:"500",boxShadow:"0 2px 4px rgba(0,0,0,0.14)",minWidth:"80px",height:"38px",opacity:te?.7:1,userSelect:"none"};return n.jsx("button",{onClick:()=>ct(t.id,b.key,t.track_id),disabled:te,style:he,onMouseOver:e=>{te||(e.currentTarget.style.backgroundColor=d.secondary,e.currentTarget.style.color="white",e.currentTarget.style.boxShadow="0 4px 8px rgba(0,0,0,0.12)",e.currentTarget.style.transform="translateY(-1px)")},onMouseOut:e=>{te||Object.assign(e.currentTarget.style,{backgroundColor:he.backgroundColor,color:he.color,boxShadow:he.boxShadow,transform:"translateY(0)"})},children:I},b.key)})]})]}),n.jsx("div",{children:!o&&n.jsxs("button",{onClick:lt,style:ae,onMouseOver:b=>{b.currentTarget.style.backgroundColor=d.containerBg,b.currentTarget.style.color="#000000",b.currentTarget.style.transform="translateY(-2px)",b.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.08)"},onMouseOut:b=>{b.currentTarget.style.backgroundColor=d.secondaryLight,b.currentTarget.style.color=d.secondary,b.currentTarget.style.transform="translateY(0)",b.currentTarget.style.boxShadow="none"},children:["Skip",n.jsx(St,{})]})})]})]},o?"skeleton":t.id)};return n.jsxs("div",{className:"reward-sdk-container",style:{...pe,padding:"0px 20px 0px 20px",position:"relative"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",alignItems:"center",padding:"15px 16px 5px 20px ",gap:"10px"},children:[n.jsx("button",{onClick:He,title:"Preferences",style:{width:"32px",height:"32px",background:"transparent",border:"none",cursor:"pointer",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",color:d.secondary,transition:"all 0.2s ease",backgroundColor:"#e0e0e0",userSelect:"none",fontSize:"16px"},onMouseOver:t=>{t.currentTarget.style.color="#000000",t.currentTarget.style.backgroundColor="#d4d4d4",t.currentTarget.style.boxShadow="0 2px 5px rgba(0,0,0,0.2)"},onMouseOut:t=>{t.currentTarget.style.color=d.secondary,t.currentTarget.style.backgroundColor="#e0e0e0",t.currentTarget.style.boxShadow="none"},children:n.jsx(Tt,{})}),U&&n.jsx("button",{onClick:()=>{window.confirm("Won't get a reward")&&U()},style:{width:"32px",height:"32px",borderRadius:"50%",backgroundColor:"#e0e0e0",color:d.secondary,border:"none",fontSize:"16px",cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center",padding:"0",boxShadow:"none",transition:"all 0.2s ease",userSelect:"none"},onMouseOver:t=>{t.currentTarget.style.color="#000000",t.currentTarget.style.backgroundColor="#d4d4d4",t.currentTarget.style.boxShadow="0 2px 5px rgba(0,0,0,0.2)"},onMouseOut:t=>{t.currentTarget.style.color=d.secondary,t.currentTarget.style.backgroundColor="#e0e0e0",t.currentTarget.style.boxShadow="none"},"aria-label":"Close",children:n.jsx(kt,{})})]}),n.jsx(jt,{showPreferences:$,skipPreferences:Re,topicsDict:X,colors:d,formatTopicName:Je,prefSubmitStatus:De,updateProfile:$e}),!$&&n.jsx(n.Fragment,{children:G&&!C?n.jsx("div",{children:Ge(null,!0)}):q?n.jsxs("div",{style:{padding:"40px 20px",textAlign:"center",backgroundColor:d.errorLight,borderRadius:"12px",color:d.error,border:`1px solid ${d.error}25`},children:[n.jsx("div",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"8px"},children:"Connection Error"}),n.jsx("div",{children:q}),n.jsx("button",{onClick:F,style:{marginTop:"20px",padding:"10px 20px",backgroundColor:d.error,color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"500",userSelect:"none"},children:"Retry Connection"})]}):n.jsx("div",{children:Array.isArray(j)?n.jsx(n.Fragment,{children:j.map(t=>Ge(t,!1))}):null})})]})};typeof window<"u"&&(window.RewardSdk||(window.RewardSdk=nt)),oe.RewardSdk=nt,oe.default=nt,Object.defineProperties(oe,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
